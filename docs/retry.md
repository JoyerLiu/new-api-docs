# 渠道重试

## 重试功能说明

渠道重试功能已经实现,可以在`设置->运营设置->通用设置`设置重试次数。

重试规则:
- 第一次重试使用同优先级
- 第二次重试使用下一个优先级
- 以此类推

## 缓存配置

!!! tip
    建议开启缓存功能以提升重试性能

### 启用缓存方式

1. 使用 Redis 缓存:
设置环境变量 `REDIS_CONN_STRING`
```
REDIS_CONN_STRING=redis://default:redispw@localhost:49153
```

2. 使用内存缓存:
设置环境变量 `MEMORY_CACHE_ENABLED=true`

!!! note
    如果已设置Redis则无需设置内存缓存

## 错误码处理

默认情况下,这些错误码不会重试:
- 400
- 504  
- 524

### 自定义错误码重试

如果需要让400错误也重试,可以在`渠道->编辑`中,将`状态码复写`改为:

```json
{
  "400": "500"
}
```

这样可以实现将400错误转为500错误,从而触发重试机制。 